{% extends "layout.html" %}
{% block main %}
{% include 'navbar.html' %}
		<section id="dev-cards">
			<h1 class="sec-title">Devices</h1>
			<div class="cards">
				{% if devs['temp_hum_sensors'] %}
				<div id="card-temp" class="card">
					<div class="card-title">Temperature</div>
					<div class="card-value">{{devs['averages'][1]}}°C</div>
					{% for name, state in devs['temp_hum_sensors'].items() %}
					<div id="{{name}}" class="card-item">
						<div class="card-item-name">{{name}}</div>
						<div class="card-output">{{state[0]}}°C</div>						
					</div>
					{% endfor %}		
				</div>

				<div id="card-hum" class="card">
					<div class="card-title">Humidity</div>
					<div class="card-value">{{devs['averages'][2]}}%</div>
					{% for name, state in devs['temp_hum_sensors'].items() %}
					<div id="{{name}}" class="card-item">
						<div class="card-item-name">{{name}}</div>
						<div class="card-output">{{state[1]}}%</div>						
					</div>
					{% endfor %}	
				</div>
				{% endif %}
				{% if devs['soil_moist_sensors'] %}
				<div id="card-moist" class="card">
					<div class="card-title">Soil Moisture</div>
					<div class="card-value">{{devs['averages'][3]}}%</div>
					{% for name, state in devs['soil_moist_sensors'].items() %}
					<div id="{{name}}" class="card-item">
						<div class="card-item-name">{{name}}</div>
						<div class="card-output">{{state}}%</div>						
					</div>
					{% endfor %}							
				</div>
				{% endif %}
			</div>
			<div class="cards">
				{% if devs['ventilation'] %}
				<div id="card-fan" class="card">
					<div class="card-title">Ventilation</div>
					{% if devs['active_control'][0] %}
					<div class="green card-act-switch">AUTO</div>
					{% else %}
					<div class="red card-act-switch">MAN</div>
					{% endif %}
					{% for name, state in devs['ventilation'].items() %}
					<div id="{{name}}" class="card-item">
						<div class="card-item-name">{{name}}</div>
						{% if not state[0] %}
						<div class="toggle-button">
						{% elif state[1]<=50 %}
						<div class="toggle-button-on">
						{% else %}
						<div class="toggle-button-two">
						{% endif %}
							<div class="zero" data-target="off"></div>
							<div class="one" data-target="fan-50"></div>
							<div class="two" data-target="fan-100"></div>
						</div>	
					</div>
					{% endfor %}					
				</div>
				{% endif %}
				{% if devs['heating'] %}
				<div id="card-heating" class="card">
					<div class="card-title">Heating</div>
					{% if devs['active_control'][1] %}
					<div class="green card-act-switch">AUTO</div>
					{% else %}
					<div class="red card-act-switch">MAN</div>
					{% endif %}
					{% for name, state in devs['heating'].items() %}
					<div id="{{name}}" class="card-item">
						<div class="card-item-name">{{name}}</div>
						{% if not state %}
						<div class="toggle-button">
						{% else %}
						<div class="toggle-button-on">
						{% endif %}
							<div class="zero" data-target="off"></div>
							<div class="one" data-target="on"></div>
						</div>						
					</div>
					{% endfor %}		
				</div>
				{% endif %}
				{% if devs['grow_lights'] %}
				<div id="card-glights" class="card">
					<div class="card-title">Grow Lights</div>
					{% if devs['active_control'][2] %}
					<div class="green card-act-switch">AUTO</div>
					{% else %}
					<div class="red card-act-switch">MAN</div>
					{% endif %}
					{% for name, state in devs['grow_lights'].items() %}
					<div id="{{name}}" class="card-item">
						<div class="card-item-name">{{name}}</div>
						{% if not state %}
						<div class="toggle-button">
						{% else %}
						<div class="toggle-button-on">
						{% endif %}
							<div class="zero" data-target="off"></div>
							<div class="one" data-target="on"></div>
						</div>						
					</div>	
					{% endfor %}				
				</div>
				{% endif %}
				{% if devs['irrigation'] %}
				<div id="card-water" class="card">
					<div class="card-title">Irrigation</div>
					{% if devs['active_control'][3] %}
					<div class="green card-act-switch">AUTO</div>
					{% else %}
					<div class="red card-act-switch">MAN</div>
					{% endif %}
					{% for name, state in devs['irrigation'].items() %}
					<div id="{{name}}" class="card-item">
						<div class="card-item-name">{{name}}</div>
						{% if not state[0] %}
						<div class="toggle-button">
						{% else %}
						<div class="toggle-button-on">
						{% endif %}
							<div class="zero" data-target="off"></div>
							<div class="one" data-target="on"></div>
						</div>						
					</div>	
					{% endfor %}				
				</div>
				{% endif %}				
			</div>
			{% if devs['cameras'] %}
			<div class="cards">
				{% for name in devs['cameras'] %}
				<div class="card">
					<div class="card-title">{{name}}</div>
					<div class="card-cam-snapshot"></div>
				</div>
				{% endfor %}		
			</div>
			{% endif %}
		</section>
		<section id="dev-config">
			<h1 class="sec-title">Configurations</h1>
			<div class="cards">
				<div id="dev-table-container">
					<table id="dev-table">
						<thead>
							<tr>
								<th>Name</th>
								<th>Model</th>
								<th>Enabled</th>
							</tr>
						</thead>
						<tbody>	
						</tbody>
					</table>
				</div>
				<div id="dev-raw-config">
					<textarea>
					</textarea>
					<div id="edit-dev-cfg" class="blue-button">Save</div>
					<p id="edit-cfg-result" class="form-result"></p>
				</div>
			</div>
		</section>

		<script type="text/javascript" src="{{ url_for('static', filename='js/devices.js') }}"></script>
		
{% endblock %}